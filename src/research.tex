\chapter{Исследование существующих методов \\распознавания объектов на изображении}

\section{Классификация алгоритмов}
Существует несколько характерных классификаций для методов распознания объектов.

По степени используемой обучающей информации:
\begin{itemize}[label=---]
    \item <<распознавание с учителем>> --- заключается в том, что данные предописываются тем, кто проводит исследование, то есть размечаются по какому-либо принципу;
    \item <<распознавание без учителя>> --- модель обучается на данных, которые не были предварительно обработаны, таким образом модели приходится самой выделять полезные признаки из изображения.
\end{itemize}

По принципу реализации метода:
\begin{itemize}[label=---]
    \item метод перебора --- обрабатываемые изображения сравниваются с имеющейся в базе информацией, которая хранит все модификации изображения;
    \item анализ характеристик образа --- основывается на более глубоком изучении исследуемого образа, например, определении его геометрических характеристик, цвета, линейных размеров и так далее;
    \item использование нейронных сетей --- метод, требующий большого количества обучающих данных и значительных вычислительных ресурсов, но позволяющий получать больше полезной информации о снимке. В последнее время такие системы активно развиваются и появляются все более эффективные принципы их построения~\cite{analysis_img}.
\end{itemize}

\section{Методы детектирования объектов на \\изображении}

В данном разделе будут представлены основные методы распознавания объектов на снимке.

\subsection{Поиск контуров}
Алгоритм поиска контуров заключается в применении математических методов, направленных на выявление точек в цифровом изображении, в которых яркость и цвет резко меняется. Такие точки организованы в виде набора кривых линий и называются границами или контурами.

Изменение яркости изображения может соответствовать: различным материалам, различию в освещении отдельных частей сцены, перепадам глубины или изменению ориентации поверхности. В идеальном случае определение краев помогает установить границы и форму объекта.

Существуют различные методы контурного анализа. Ниже рассмотрены некоторые из них.
\begin{itemize}[label=---]
    \item Метод активных контуров. Для обнаружения границ на изображении применяются кривые минимальной энергии. Контур инициализируется как простая линия, а потом изменяется, чтобы создать область объекта. Каждая точка в контуре стремится к границе объекта при минимизации ее функции энергии~\ref{eq:power_func}.
    \begin{equation}
    \label{eq:power_func}
        E_i = \alpha E_{int}(v_i) + \beta E_{ext}(v_i),
    \end{equation}
    где $\alpha$, $\beta$ --- константы, необходимые для коррекции энергии, $E_{int}(v_i)$, $E_{ext}(v_i)$ --- функции энергии, зависящие от формы контура и от свойств изображения соответственно.
    \item Детектор границ Кэнни. Данный алгоритм включает в себя сглаживание, поиск градиентов, подавление немаксимумов, двойную пороговую фильтрацию и трассировку области неоднозначности. Все данные этапы нацелены на то, чтобы детектор мог точно определять линию границы и реагировать на каждую ровно один раз, но при этом игнорировал ложные. Более того алгоритм Кэнни устойчив к шумам на изображении благодаря использованию метода Гаусса. На рисунке \ref{img:det_kanny} продемонстирован пример работы детектора границ Кэнни~\cite{border}.
    \imgScale{0.7}{det_kanny}{Пример работы детектора границ Кэнни}
    \item Кластеризация. Данный метод является наиболее эффективным для изображений с помехами. Пусть есть две линии, которые обозначены как $\{a_1,~...,~a_n\}\in A$ и $\{b_1,~...,~b_n\}\in B$ при условии, что они удовлетворяют следующим неравенствами:
    \begin{equation}
    \label{eq:func_1}
        \{|x_a_i - x_b_j| + |y_a_i - y_b_j|\} \leq \alpha_d;
    \end{equation}
    \begin{equation}
    \label{eq:func_2}
        \{|u_a_i - u_b_j|\} \leq \alpha_u;
    \end{equation}
    \begin{equation}
    \label{eq:func_1}
        \{|v_a_i - v_b_j|\} \leq \alpha_v,
    \end{equation}
    где $\alpha_d$, $\alpha_u$ и $\alpha_v$ --- пороговые константы; $u_a$, $v_a$ --- составляющие скорости точки $a$ в координатах $(x_a,~y_a)$~\cite{border}.
\end{itemize}

Несмотря на то, что алгоритмы поиска контуров являются довольно простыми в реализации с математической точки зрения, они имеют ряд значительных ограничений, которые не позволяют использовать эти методы повсеместно:
\begin{itemize}[label=---]
    \item они не могут быть применены, если на изображении невозможно различить контур, например, из-за плохого цветового контраста;
    \item они не способны адекватно обработать перекрытие одних объектов другими;
    \item большинство из них неустойчивы к шуму (кроме метода Кэнни), плохая видимость или плохое качество изображения сильно ухудшают результат их работы~\cite{comp_vision}.
\end{itemize}

% \subsection{Методы, основанные на оценках плотностей распределения значений признаков}
% Данные методы распознавания образов основаны на классической теории статистических решений, в которой объекты исследования рассматривают как реализации многомерной случайной величины, распределенной в пространстве признаков по какому-либо закону. Они базируются на байесовской схеме принятия решений, в которой рассчитывается вероятность принадлежности к тому или иному классу по плотностям распределения значений вектора признаков.

% Основным недостатком данных алгоритмов является необходимость запоминания всей обучающей выборки для вычисления оценок локальных плотностей распределения и высокая чувствительность к непредставительности обучающей выборки.

\subsection{Метод сравнения с эталоном}
Это один из простых методов распознавания, который заключается в сравнении с эталоном. Эталоны --- изображения, которые имеют форму и признаки исследуемых предметов и заранее классифицированы по группам. Тогда задача обнаружения сводится к тому, чтобы проверить снимок на наличие частей похожих на эталон, и в случае обнаружения отнести найденный объект к классу эталона. В качестве меры близости могут применяться различные типы расстояний.

Так, например, при поиске объекта по некому шаблону формы часто используется среднеквадратичная разность значений яркости изображений шаблона и анализируемого снимка \ref{eq:kvad_r}. На рисунке \ref{img:etalon} показан пример обхода изображения шаблоном формы~\cite{etalon}.

\begin{equation}
\label{eq:kvad_r}
    \texttt{diff} = \frac{\sqrt{\sum_{i=0}^\infty(pixelI1_i - pixelI2_i)\cdot(pixelI1_i - pixelI2_i)}}{n - 1}
\end{equation}

\imgScale{1}{etalon}{Пример обхода изображения шаблоном формы}

Метод сравнения с эталоном часто применяется, когда речь идет о задачах небольшой размерности пространства признаков. Однако он имеет высокую зависимость результатов классификации от выбранной меры близости изучаемого экземпляра и прототипа.

\subsection{Сверточные нейронные сети}
Сверточные нейронные сети --- это разновидность моделей глубокого обучения, которые очень часто используются для распознавания образов. Главной идеей данной технологии является операция свертывания, которая заключается в извлечении шаблонов из входной карты признаков и их последующего одинакового преобразования для получения выходной карты признаков (рисунок \ref{img:example})~\cite{deep_learning}.

\imgScale{1}{example}{Пример разбития изображения на шаблоны}

Картой признаков в этом случае называют трехмерный тензор, у которого две оси указывают размерность изображения (высоту и ширину), а третья --- глубину, которая соответвует так называемым фильтрам, отвечающим за наличие того или иного параметра на изучаемом шаблоне (рисунок~\ref{img:example2}~\cite{deep_learning}). Фильтры представляют собой конкретные аспекты входных данных: на верхнем уровне, например, они могут соответствовать понятию <<присутствие лица на входе>>.

\imgScale{1}{example2}{Понятие карты признаков}
\FloatBarrier

Однако при использовании нейронных сетей можно столкнуться с некоторыми проблемами:
\begin{itemize}[label=---]
    \item для максимального качества результата необходим большой объем обучающих данных;
    \item при ограниченном объеме данных главной проблемой становится переобучение нейронной сети, с которой приходится бороться различными методами.
\end{itemize}

\section{Вывод}
Изучив вышеописанные методы, можно сказать, что нельзя выделить один единственный, который явно превосходил бы остальные по всем параметрам. Каждый из изученных алгоритмов имеет свои преимущества и недостатки. Все они могут применяться для решения узконаправленных задач, в которых данные не противоречат ограничениям этих методов.

Однако в настоящее время в большинстве случаев, когда необходимо распознать тот или иной объект на снимке, используют технологию сверточных нейронных сетей. Несмотря на то, что для реализации такой системы требуется большое количество тренировочных данных и вычислительных ресурсов, она зарекомендовала себя как одну из самых эффективных. Эта модель способна обучаться и выделять намного больше полезных признаков со снимка на каждой итерации <<тренировки>>. Также в ее алгоритмах обработки изображений возможно использование ранее изученных методов, что дает гибкость в решении различных задач.

